{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./product.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction ProductComponent_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductComponent_div_4_option_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 5);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const country_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", country_r4.code)(\"selected\", country_r4.code === \"USA\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", country_r4.name, \" \");\n  }\n}\nfunction ProductComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"currency\");\n    i0.ɵɵelementStart(4, \"select\", 3);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductComponent_div_4_Template_select_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.selectedCountry = $event);\n    })(\"change\", function ProductComponent_div_4_Template_select_change_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const product_r2 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.onCountrySelection(product_r2, ctx_r7.selectedCountry));\n    });\n    i0.ɵɵtemplate(5, ProductComponent_div_4_option_5_Template, 2, 3, \"option\", 4);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const product_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" \", product_r2.name, \" - \", i0.ɵɵpipeBind2(3, 4, product_r2.price, product_r2.currency), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.selectedCountry);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.countries);\n  }\n}\n//implements OnInit \nexport class ProductComponent {\n  /*  constructor(http: HttpClient, @Inject('BASE_URL') baseUrl: string, private currencyService: CurrencyService) {\r\n     http.get<Product[]>(baseUrl + 'products').subscribe(result => {\r\n       this.products = result;\r\n     }, error => console.error(error));\r\n   } */\n  constructor(productService) {\n    this.productService = productService;\n    this.products = [];\n    this.exchangeRates = [];\n    this.countries = [];\n    this.currencies = ['USD', 'EUR', 'AUD'];\n    this.selectedCurrency = 'USD';\n  }\n  ngOnInit() {\n    this.loadProducts();\n    this.loadExchangeRates();\n    this.loadCountries();\n  }\n  loadProducts() {\n    this.productService.getProducts().subscribe(products => this.products = products);\n  }\n  loadExchangeRates() {\n    this.productService.getExchangeRates().subscribe(exchangeRates => this.exchangeRates = exchangeRates);\n  }\n  loadCountries() {\n    this.productService.getCountries().subscribe(countries => this.countries = countries);\n  }\n  /*   onCurrencyChange(currency: string) {\r\n      this.selectedCurrency = currency;\r\n      this.currencyService.setCurrency(currency);\r\n    }\r\n  \r\n    convertPrice(price: number, targetCurrency: string): number {\r\n      // Implement logic for currency conversion here\r\n      // This is a placeholder and should be replaced with actual conversion logic\r\n      return price;\r\n    } */\n  getExchangeRateForCurrency(currency) {\n    const exchangeRate = this.exchangeRates.find(rate => rate.currencyCode === currency);\n    return exchangeRate ? exchangeRate.rate : 1;\n  }\n  changeCurrency(product) {\n    console.log(product.id);\n    console.log(this.selectedCurrency);\n    const currentDate = new Date();\n    const exchangeRate = this.getExchangeRateForCurrency(this.selectedCurrency);\n    console.log('Final Exchange Rate:', exchangeRate);\n    // const priceInSelectedCurrency = product * exchangeRate;\n    // console.log('Price in Selected Currency:', priceInSelectedCurrency);\n    // return priceInSelectedCurrency;\n    this.productService.convertPrice(product.id, this.selectedCurrency, exchangeRate).subscribe(convertedProduct => {\n      // Update the product list with the converted product\n      const index = this.products.findIndex(p => p.id === convertedProduct.id);\n      if (index !== -1) {\n        console.log(convertedProduct.price);\n        console.log(convertedProduct.name);\n        this.products[index] = convertedProduct;\n      }\n    });\n  }\n  getExchangeRateForProduct(product) {\n    const exchangeRate = this.exchangeRates.find(rate => rate.currencyCode === product.currency);\n    return exchangeRate ? exchangeRate.rate : 1;\n  }\n  onCountrySelection(product, selectedCountryCode) {\n    const selectedCountry = this.countries.find(country => country.countryCode === selectedCountryCode);\n    if (selectedCountry) {\n      const exchangeRate = this.exchangeRates.find(rate => rate.currencyCode === selectedCountry.currencyCode);\n      if (exchangeRate) {\n        const newPrice = product.price / this.getExchangeRateForProduct(product) * exchangeRate.rate;\n        // Update the product's price\n        product.price = newPrice;\n      }\n    }\n  }\n  static #_ = this.ɵfac = function ProductComponent_Factory(t) {\n    return new (t || ProductComponent)(i0.ɵɵdirectiveInject(i1.ProductService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductComponent,\n    selectors: [[\"app-product\"]],\n    decls: 5,\n    vars: 2,\n    consts: [[\"id\", \"tableLabel\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngModel\", \"ngModelChange\", \"change\"], [3, \"value\", \"selected\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\", \"selected\"]],\n    template: function ProductComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\", 0);\n        i0.ɵɵtext(1, \"Product List\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(2, ProductComponent_p_2_Template, 3, 0, \"p\", 1);\n        i0.ɵɵelementStart(3, \"div\");\n        i0.ɵɵtemplate(4, ProductComponent_div_4_Template, 6, 7, \"div\", 2);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", !ctx.products);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.products);\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel, i2.CurrencyPipe],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ProductComponent","constructor","productService","ngOnInit","loadProducts","loadExchangeRates","loadCountries","getProducts","subscribe","products","getExchangeRates","exchangeRates","getCountries","countries","getExchangeRateForCurrency","currency","exchangeRate","find","rate","currencyCode","changeCurrency","product","console","log","id","selectedCurrency","currentDate","Date","convertPrice","convertedProduct","index","findIndex","p","price","name","getExchangeRateForProduct","onCountrySelection","selectedCountryCode","selectedCountry","country","countryCode","newPrice","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\ASHISH\\AngularTJX\\AngularPOC\\ClientApp\\src\\app\\product\\product.component.html","C:\\ASHISH\\AngularTJX\\AngularPOC\\ClientApp\\src\\app\\product\\product.component.ts"],"sourcesContent":["<h1 id=\"tableLabel\">Product List</h1>\n\n\n\n<p *ngIf=\"!products\"><em>Loading...</em></p>\n\n<div>\n \n  <div *ngFor=\"let product of products\">\n    <p>\n      {{ product.name }} -\n      {{ product.price | currency:product.currency }}\n      <select [(ngModel)]=\"selectedCountry\" (change)=\"onCountrySelection(product, selectedCountry)\">\n        <option *ngFor=\"let country of countries\" [value]=\"country.code\" [selected]=\"country.code === 'USA'\">\n          {{ country.name }}\n        </option>\n      </select>\n    </p>\n  </div>\n  </div>\n  \n","\nimport { Component, OnInit, Inject } from '@angular/core';\nimport { ProductService } from './product.service';\nimport { Product } from '../product.model';\nimport { CurrencyService } from '../currency.service';\nimport { HttpClient } from '@angular/common/http';\nimport { ExchangeRate } from '../exchange.model';\nimport { Country } from '../country.model';\n\n\n@Component({\n  selector: 'app-product',\n  templateUrl: './product.component.html',\n  styleUrls: ['./product.component.css']\n})\n//implements OnInit \nexport class ProductComponent implements OnInit{\n  products: Product[] = [];\n  exchangeRates: ExchangeRate[] = [];\n  countries: Country[] = [];\n  currencies: string[] = ['USD', 'EUR', 'AUD'];\n  selectedCurrency: string = 'USD';\n /*  constructor(http: HttpClient, @Inject('BASE_URL') baseUrl: string, private currencyService: CurrencyService) {\n    http.get<Product[]>(baseUrl + 'products').subscribe(result => {\n      this.products = result;\n    }, error => console.error(error));\n  } */\n\n  constructor(private productService: ProductService) {}\n\n  ngOnInit() {\n    this.loadProducts();\n    this.loadExchangeRates();\n    this.loadCountries();\n  }\n\n  loadProducts() {\n    this.productService.getProducts().subscribe(products => (this.products = products));\n    \n  }\n\n  loadExchangeRates() {\n    this.productService.getExchangeRates().subscribe(exchangeRates => (this.exchangeRates = exchangeRates));\n  }\n\n  loadCountries() {\n    this.productService.getCountries().subscribe(countries => (this.countries = countries));\n  }\n\n/*   onCurrencyChange(currency: string) {\n    this.selectedCurrency = currency;\n    this.currencyService.setCurrency(currency);\n  }\n\n  convertPrice(price: number, targetCurrency: string): number {\n    // Implement logic for currency conversion here\n    // This is a placeholder and should be replaced with actual conversion logic\n    return price;\n  } */\n\n  getExchangeRateForCurrency(currency: string): number {\n    const exchangeRate = this.exchangeRates.find(rate => rate.currencyCode === currency);\n    return exchangeRate ? exchangeRate.rate : 1;\n  }\n\n  changeCurrency(product: Product) {\n    console.log(product.id);\n\n    console.log(this.selectedCurrency);\n    const currentDate = new Date();\n\n   \n    const exchangeRate = this.getExchangeRateForCurrency(this.selectedCurrency) ;\n    console.log('Final Exchange Rate:', exchangeRate);\n    \n    // const priceInSelectedCurrency = product * exchangeRate;\n    // console.log('Price in Selected Currency:', priceInSelectedCurrency);\n  \n    // return priceInSelectedCurrency;\n\n    this.productService.convertPrice(product.id, this.selectedCurrency, exchangeRate).subscribe(convertedProduct => {\n      // Update the product list with the converted product\n      const index = this.products.findIndex(p => p.id === convertedProduct.id);\n      if (index !== -1) {\n        console.log(convertedProduct.price);\n        console.log(convertedProduct.name);\n        this.products[index] = convertedProduct;\n      }\n    });\n  }\n  getExchangeRateForProduct(product: Product): number {\n    const exchangeRate = this.exchangeRates.find(rate => rate.currencyCode === product.currency);\n    return exchangeRate ? exchangeRate.rate : 1;\n  }\n  onCountrySelection(product: Product, selectedCountryCode: string): void {\n    const selectedCountry = this.countries.find(country => country.countryCode === selectedCountryCode);\n    if (selectedCountry) {\n      const exchangeRate = this.exchangeRates.find(rate => rate.currencyCode === selectedCountry.currencyCode);\n      if (exchangeRate) {\n        const newPrice = (product.price / this.getExchangeRateForProduct(product)) * exchangeRate.rate;\n        // Update the product's price\n        product.price = newPrice;\n      }\n    }\n  }\n  \n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}